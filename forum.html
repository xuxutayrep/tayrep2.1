<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>论坛 - Taylor Swift Club</title>
    <!-- 主样式 -->
    <style>
        /* 全局变量 */
        :root {
            --primary-color: #2c3e50; 
            --bg-color: #f8f9fa;
        }

        /* 通用样式 */
        body {
            background: #f5f3ee;
            color: #6e6259;
            font-family: 'Roboto', sans-serif;
            transition: background 0.5s;
            position: relative;
            min-height: 100vh;
            overflow-x: hidden;
        }
        @keyframes flowing-bg {
            0% {background-position: 0% 50%;}
            25% {background-position: 50% 100%;}
            50% {background-position: 100% 50%;}
            75% {background-position: 50% 0%;}
            100% {background-position: 0% 50%;}
        }
        body::before {
            content: '';
            position: fixed;
            left: 0; top: 0; right: 0; bottom: 0;
            pointer-events: none;
            z-index: 0;
            opacity: 0.15;
            background: url('https://www.transparenttextures.com/patterns/noise.png');
        }
        .container, .section-padding, nav, footer {
            position: relative;
            z-index: 1;
        }

        .section-padding {
            padding: 5rem 1rem;
        }

        /* 导航栏 */
        .navbar {
            background-color: rgba(255,255,255,0.9); /* 增加不透明度 */
            box-shadow: 0 4px 20px rgba(0,0,0,0.15); /* 增强阴影效果 */
            justify-content: center !important;
            border-radius: 12px; /* 添加圆角 */
            margin: 10px 20px; /* 添加外边距 */
            backdrop-filter: blur(10px); /* 添加模糊效果 */
            position: sticky;
            top: 10px; /* 距离顶部有一定距离 */
            z-index: 1000;
            transition: all 0.3s ease; /* 添加过渡效果 */
        }

        /* 添加悬停效果 */
        .navbar:hover {
            box-shadow: 0 6px 25px rgba(0,0,0,0.2);
            transform: translateY(-2px);
        }

        /* 导航项样式优化 */
        .navbar .nav-link {
            font-weight: 500;
            padding: 10px 15px;
            transition: color 0.3s ease;
        }

        .navbar .nav-link:hover {
            color: #bfa14a;
        }
        @font-face {
            font-family: 'Somer';
            src: url('Somer.ttf') format('truetype');
            font-display: swap;
        }
        @font-face {
            font-family: 'TaytexAlt';
            src: url('Taytex Alt.ttf') format('truetype');
            font-display: swap;
        }
        @font-face {
            font-family: 'IMFePIrm28P';
            src: url('IMFePIrm28P.ttf') format('truetype');
            font-display: swap;
        }
        .navbar .navbar-brand {
            margin: 0 auto;
            font-family: 'Somer', cursive, 'Roboto', sans-serif !important;
            font-size: 1.2rem;
            letter-spacing: 2px;
        }
        .navbar .container {
            position: relative;
        }
        .navbar-toggler {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        /* 论坛iframe样式 */
        .forum-container {
            width: 100%;
            min-height: 800px;
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-top: 2rem;
            background-color: #fff;
        }

        /* 加载中动画 */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 400px;
            font-size: 1.5rem;
            color: #bfa14a;
        }
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(191, 161, 74, 0.3);
            border-radius: 50%;
            border-top-color: #bfa14a;
            animation: spin 1s ease-in-out infinite;
            margin-right: 15px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* 移动端样式 */
        @media (max-width: 768px) {
            .forum-container {
                min-height: 600px;
            }
        }
    </style>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body style="background: #f5f3ee; color: #6e6259; min-height: 100vh;">

  <!-- ====== 导航栏 ====== -->
  <div class="container">
    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
      <div class="container position-relative d-flex align-items-center">
        <a class="navbar-brand" href="index.html">Taylor Swift Club</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="index.html" data-i18n="home">首页</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#latest-album">最新专辑</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#photos" data-i18n="photos">官方照片</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#videos" data-i18n="videos">视频作品</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#music" data-i18n="music">音乐作品</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="store.html" data-i18n="store" target="_blank">商店</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="forum.html">论坛</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="index.html#footer" data-i18n="followMe">Follow me</a>
            </li>
          </ul>
        </div>
        <!-- 右侧按钮区域 -->
        <div class="d-flex align-items-center">
          <!-- 赞赏按钮 -->
          <button class="btn me-2 appreciate-btn" type="button" data-bs-toggle="modal" data-bs-target="#appreciateModal">
            <i class="fas fa-heart"></i> 赞赏
          </button>
        </div>
      </div>
    </nav>
  </div>

  <!-- ====== 论坛主体内容 ====== -->
  <section class="section-padding">
    <div class="container">
      <h2 class="text-center mb-4" style="font-family: 'Somer', cursive, 'Roboto', sans-serif; color: #2c3e50;">Taylor Swift Club 论坛</h2>
      <p class="text-center mb-5">加入我们的社区，与其他粉丝一起讨论关于Taylor Swift的一切！</p>
      
      <!-- 论坛内容 -->
      <div id="forum-content">
        <div class="forum-categories mb-5">
          <div class="row">
            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title"><i class="fas fa-music me-2"></i>音乐讨论</h5>
                  <p class="card-text">分享Taylor Swift的音乐、歌词和你喜欢的歌曲。</p>
                  <a href="#music-discussion" class="btn btn-sm" style="background-color: #bfa14a; color: white;">进入讨论</a>
                </div>
              </div>
            </div>
            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title"><i class="fas fa-ticket-alt me-2"></i>演唱会交流</h5>
                  <p class="card-text">分享演唱会经历、票务信息和现场照片。</p>
                  <a href="#concert-discussion" class="btn btn-sm" style="background-color: #bfa14a; color: white;">进入讨论</a>
                </div>
              </div>
            </div>
            <div class="col-md-4 mb-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title"><i class="fas fa-tshirt me-2"></i>周边收藏</h5>
                  <p class="card-text">分享你的Taylor Swift周边收藏和购买建议。</p>
                  <a href="#merch-discussion" class="btn btn-sm" style="background-color: #bfa14a; color: white;">进入讨论</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 音乐讨论区 -->
        <div id="music-discussion" class="mb-5">
          <h3 class="mb-4" style="font-family: 'Somer', cursive, 'Roboto', sans-serif; color: #2c3e50;">音乐讨论</h3>
          
          <!-- Netlify评论表单 - 音乐讨论 -->
          <div class="netlify-comments-container">
            <div class="comments-list mb-4" id="music-comments-list">
              <!-- 评论将在这里显示 -->
              <p class="text-muted">正在加载评论...</p>
            </div>
            
            <form name="music-comments" method="POST" data-netlify="true" class="comment-form" id="music-comment-form">
              <input type="hidden" name="form-name" value="music-comments">
              <input type="hidden" name="section" value="music">
              
              <div class="mb-3">
                <label for="music-name" class="form-label">昵称</label>
                <input type="text" class="form-control" id="music-name" name="name" required>
              </div>
              
              <div class="mb-3">
                <label for="music-email" class="form-label">邮箱 (不会公开显示)</label>
                <input type="email" class="form-control" id="music-email" name="email" required>
              </div>
              
              <div class="mb-3">
                <label for="music-comment" class="form-label">评论</label>
                <textarea class="form-control" id="music-comment" name="comment" rows="4" required></textarea>
              </div>
              
              <button type="submit" class="btn" style="background-color: #bfa14a; color: white;">发表评论</button>
            </form>
          </div>
        </div>
        
        <!-- 演唱会讨论区 -->
        <div id="concert-discussion" class="mb-5">
          <h3 class="mb-4" style="font-family: 'Somer', cursive, 'Roboto', sans-serif; color: #2c3e50;">演唱会交流</h3>
          
          <!-- Netlify评论表单 - 演唱会讨论 -->
          <div class="netlify-comments-container">
            <div class="comments-list mb-4" id="concert-comments-list">
              <!-- 评论将在这里显示 -->
              <p class="text-muted">正在加载评论...</p>
            </div>
            
            <form name="concert-comments" method="POST" data-netlify="true" class="comment-form" id="concert-comment-form">
              <input type="hidden" name="form-name" value="concert-comments">
              <input type="hidden" name="section" value="concert">
              
              <div class="mb-3">
                <label for="concert-name" class="form-label">昵称</label>
                <input type="text" class="form-control" id="concert-name" name="name" required>
              </div>
              
              <div class="mb-3">
                <label for="concert-email" class="form-label">邮箱 (不会公开显示)</label>
                <input type="email" class="form-control" id="concert-email" name="email" required>
              </div>
              
              <div class="mb-3">
                <label for="concert-comment" class="form-label">评论</label>
                <textarea class="form-control" id="concert-comment" name="comment" rows="4" required></textarea>
              </div>
              
              <button type="submit" class="btn" style="background-color: #bfa14a; color: white;">发表评论</button>
            </form>
          </div>
        </div>
        
        <!-- 周边收藏讨论区 -->
        <div id="merch-discussion" class="mb-5">
          <h3 class="mb-4" style="font-family: 'Somer', cursive, 'Roboto', sans-serif; color: #2c3e50;">周边收藏</h3>
          
          <!-- Netlify评论表单 - 周边收藏讨论 -->
          <div class="netlify-comments-container">
            <div class="comments-list mb-4" id="merch-comments-list">
              <!-- 评论将在这里显示 -->
              <p class="text-muted">正在加载评论...</p>
            </div>
            
            <form name="merch-comments" method="POST" data-netlify="true" class="comment-form" id="merch-comment-form">
              <input type="hidden" name="form-name" value="merch-comments">
              <input type="hidden" name="section" value="merch">
              
              <div class="mb-3">
                <label for="merch-name" class="form-label">昵称</label>
                <input type="text" class="form-control" id="merch-name" name="name" required>
              </div>
              
              <div class="mb-3">
                <label for="merch-email" class="form-label">邮箱 (不会公开显示)</label>
                <input type="email" class="form-control" id="merch-email" name="email" required>
              </div>
              
              <div class="mb-3">
                <label for="merch-comment" class="form-label">评论</label>
                <textarea class="form-control" id="merch-comment" name="comment" rows="4" required></textarea>
              </div>
              
              <button type="submit" class="btn" style="background-color: #bfa14a; color: white;">发表评论</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ====== 赞赏模态框 ====== -->
  <div class="modal fade" id="appreciateModal" tabindex="-1" aria-labelledby="appreciateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header border-0">
          <h5 class="modal-title" id="appreciateModalLabel" style="color: #bfa14a; font-family: 'Somer', cursive, sans-serif;">感谢您的赞赏</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-center">
          <div class="row">
            <div class="col-md-6 mb-3">
              <img src="微信赞赏码.JPG" alt="微信赞赏码" class="img-fluid rounded" style="max-height: 200px;">
              <p class="mt-2">微信赞赏码</p>
            </div>
            <div class="col-md-6">
              <img src="支付宝赞赏码.JPG" alt="支付宝赞赏码" class="img-fluid rounded" style="max-height: 200px;">
              <p class="mt-2">支付宝赞赏码</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ====== 页脚 ====== -->
  <footer class="bg-white p-4" id="footer">
    <div class="container text-center">
      <!-- 社交媒体链接 -->
      <div class="mb-3">
        <h5 data-i18n="footerFollow">Follow Me</h5>
        <a href="#" class="me-3" style="color:#bfa14a;"><i class="fab fa-weibo fa-lg"></i></a>
        <a href="#" class="me-3" style="color:#bfa14a;"><i class="fab fa-twitter fa-lg"></i></a>
        <a href="#" class="me-3" style="color:#bfa14a;"><i class="fab fa-instagram fa-lg"></i></a>
        <a href="#" style="color:#bfa14a;"><i class="fab fa-youtube fa-lg"></i></a>
      </div>
      <!-- 版权信息 -->
      <div>
        <a href="#" style="color:#bfa14a;font-weight:bold;">TS官链</a>
      </div>
      <div class="mt-2" style="color:#aaa; font-size: 15px;">
        2025 TayRep All Rights Reserved.
      </div>
      <div class="mt-1">
        <a href="disclaimer.html" style="color:#aaa; font-size: 14px;">免责声明</a>
      </div>
    </div>
  </footer>

  <!-- ====== JavaScript ====== -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 添加滚动效果，当页面滚动时改变导航栏样式
      window.addEventListener('scroll', function() {
        const navbar = document.querySelector('.navbar');
        if (window.scrollY > 50) {
          navbar.style.backgroundColor = 'rgba(255,255,255,0.95)';
          navbar.style.boxShadow = '0 4px 20px rgba(0,0,0,0.2)';
        } else {
          navbar.style.backgroundColor = 'rgba(255,255,255,0.9)';
          navbar.style.boxShadow = '0 4px 20px rgba(0,0,0,0.15)';
        }
      });
      
      // 解决手机端导航栏展开时与赞赏按钮重叠的问题
      const navbarCollapse = document.getElementById('navbarNav');
      const appreciateBtn = document.querySelector('.appreciate-btn');
      
      // 使用Bootstrap 5的事件监听器
      navbarCollapse.addEventListener('show.bs.collapse', function () {
        // 导航栏正在展开，隐藏赞赏按钮
        if (appreciateBtn) {
          appreciateBtn.style.display = 'none';
        }
      });
      
      navbarCollapse.addEventListener('hidden.bs.collapse', function () {
        // 导航栏已关闭，显示赞赏按钮
        if (appreciateBtn) {
          appreciateBtn.style.display = '';
        }
      });
      
      // 页面加载时检查初始状态
      if (window.innerWidth < 992 && navbarCollapse.classList.contains('show')) {
        appreciateBtn.style.display = 'none';
      }
      
      // 监听窗口大小变化
      window.addEventListener('resize', function() {
        if (window.innerWidth >= 992) {
          // 大屏幕上始终显示赞赏按钮
          if (appreciateBtn) {
            appreciateBtn.style.display = '';
          }
        } else if (navbarCollapse.classList.contains('show')) {
          // 小屏幕上导航栏展开时隐藏赞赏按钮
          if (appreciateBtn) {
            appreciateBtn.style.display = 'none';
          }
        }
      });

      // Netlify Forms评论系统处理
      document.addEventListener('DOMContentLoaded', function() {
        // 表单提交成功后的处理
        const forms = document.querySelectorAll('.comment-form');
        forms.forEach(form => {
          form.addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(form);
            const section = formData.get('section');
            
            // 显示提交中状态
            const submitButton = form.querySelector('button[type="submit"]');
            const originalText = submitButton.textContent;
            submitButton.textContent = '提交中...';
            submitButton.disabled = true;
            
            // 使用fetch API提交表单
            fetch(form.action, {
              method: 'POST',
              body: formData
            })
            .then(response => {
              if (response.ok) {
                // 清空表单
                form.reset();
                
                // 显示成功消息
                const successMessage = document.createElement('div');
                successMessage.className = 'alert alert-success mt-3';
                successMessage.textContent = '评论提交成功！审核后将显示。';
                form.appendChild(successMessage);
                
                // 3秒后移除成功消息
                setTimeout(() => {
                  form.removeChild(successMessage);
                }, 3000);
                
                // 模拟添加新评论
                const commentsList = document.getElementById(`${section}-comments-list`);
                const newComment = document.createElement('div');
                newComment.className = 'comment-item p-3 mb-3 border rounded';
                newComment.innerHTML = `
                  <div class="d-flex justify-content-between">
                    <h5>${formData.get('name')}</h5>
                    <small class="text-muted">${new Date().toLocaleString()}</small>
                  </div>
                  <p>${formData.get('comment')}</p>
                `;
                
                // 移除“正在加载”消息
                if (commentsList.querySelector('.text-muted')) {
                  commentsList.innerHTML = '';
                }
                
                commentsList.appendChild(newComment);
              } else {
                throw new Error('评论提交失败');
              }
            })
            .catch(error => {
              console.error('Error:', error);
              const errorMessage = document.createElement('div');
              errorMessage.className = 'alert alert-danger mt-3';
              errorMessage.textContent = '评论提交失败，请稍后重试。';
              form.appendChild(errorMessage);
              
              // 3秒后移除错误消息
              setTimeout(() => {
                form.removeChild(errorMessage);
              }, 3000);
            })
            .finally(() => {
              // 恢复按钮状态
              submitButton.textContent = originalText;
              submitButton.disabled = false;
            });
          });
        });
        
        // 模拟加载现有评论
        function loadComments(section) {
          const commentsList = document.getElementById(`${section}-comments-list`);
          
          // 在实际应用中，这里应该从 Netlify Functions 获取评论
          // 这里仅作演示用途模拟一些评论
          
          // 清空“正在加载”消息
          commentsList.innerHTML = '';
          
          // 模拟数据
          const demoComments = {
            'music': [
              { name: 'Taylor粉丝1', date: '2025-05-17 14:30', content: '《The Tortured Poets Department》是我今年听过的最好的专辑！' },
              { name: 'Swiftie123', date: '2025-05-16 09:15', content: '我还是最喜欢《1989》，特别是Taylor’s Version。' }
            ],
            'concert': [
              { name: '演唱会达人', date: '2025-05-15 18:45', content: '我参加了The Eras Tour的上海站，简直太棒了！' }
            ],
            'merch': [
              { name: '收藏者', date: '2025-05-14 12:20', content: '我收藏了所有Taylor的黑胶唱片，包括限量版。' },
              { name: 'TS爱好者', date: '2025-05-13 16:10', content: '有人知道哪里可以买到正版的周边吗？' },
              { name: '新粉丝', date: '2025-05-12 10:05', content: '刚买了我的第一件Taylor周边，是一件T恤，质量很好！' }
            ]
          };
          
          // 添加模拟评论
          if (demoComments[section] && demoComments[section].length > 0) {
            demoComments[section].forEach(comment => {
              const commentItem = document.createElement('div');
              commentItem.className = 'comment-item p-3 mb-3 border rounded';
              commentItem.innerHTML = `
                <div class="d-flex justify-content-between">
                  <h5>${comment.name}</h5>
                  <small class="text-muted">${comment.date}</small>
                </div>
                <p>${comment.content}</p>
              `;
              commentsList.appendChild(commentItem);
            });
          } else {
            // 如果没有评论，显示提示
            const noComments = document.createElement('p');
            noComments.className = 'text-center text-muted';
            noComments.textContent = '暂无评论，来发表第一条吧！';
            commentsList.appendChild(noComments);
          }
        }
        
        // 默认加载音乐讨论区的评论
        loadComments('music');
        
        // 点击导航时加载相应的评论
        document.querySelectorAll('a[href="#concert-discussion"]').forEach(function(link) {
          link.addEventListener('click', function() {
            loadComments('concert');
          });
        });
        
        document.querySelectorAll('a[href="#merch-discussion"]').forEach(function(link) {
          link.addEventListener('click', function() {
            loadComments('merch');
          });
        });
      });
    });
  </script>
</body>
</html>
